---
tags:
  - LeetCode
---

# [840. Magic Squares In Grid](https://leetcode.com/problems/magic-squares-in-grid/description/)  

+ 日期 : 2025/12/30  

## 問題描述  

給一個 `m x n` 的整數矩陣 `grid`，內由 `[0, 15]` 的整數組成，  
一個魔術方陣表示 `3 x 3` 的矩陣中，每一個 `row` 和 `column` 以及兩對角線的和相等，  
並且矩陣中只有 `[1, 9]` 的整數且不重複出現，問在 `grid` 中有多少個魔術方陣。  

## 直覺想法  

1. $O(n^4)$ 解法，直接硬算每個 `3 x 3` 的子矩陣是否為魔術方陣。  

## 題解  

```cpp=
class Solution {
public:
    int numMagicSquaresInside(vector<vector<int>>& grid) {
        int row = grid.size(), col = grid[0].size();
        if(row < 3 || col < 3)  return 0;
        int res = 0;
        for(int r = 0; r < row - 3 + 1; ++r) {
            for(int c = 0; c < col - 3 + 1; ++c) {
                bool isMagic = true;
                vector<int> seen(16);
                vector<int> rsum(3), csum(3);

                for(int i = r; i < r + 3; ++i) {
                    for(int j = c; j < c + 3; ++j) {
                        if(grid[i][j] > 9 || grid[i][j] == 0) {
                            isMagic = false;
                            break;
                        }
                        rsum[i-r] += grid[i][j];
                        csum[j-c] += grid[i][j];
                        seen[grid[i][j]] += 1;
                    }
                }

                int diag_0 = grid[r][c] + grid[r+1][c+1] + grid[r+2][c+2];
                int diag_1 = grid[r+2][c] + grid[r+1][c+1] + grid[r][c+2];

                if( rsum[0] != rsum[1] || rsum[0] != rsum[2] ||
                    rsum[0] != csum[0] || rsum[0] != csum[1] || rsum[0] != csum[2] ||
                    rsum[0] != diag_0 || rsum[0] != diag_1)
                    isMagic = false;
                
                for(int num : seen) {
                    if(num > 1) {
                        isMagic = false;
                    }
                }
                
                if(isMagic) res += 1;
            }
        }
        return res;
    }
};
```

Time Complexity : $O(m^2n^2)$  
Space Complexity : $O(16)$  

## 心得  

明天最後一天  
