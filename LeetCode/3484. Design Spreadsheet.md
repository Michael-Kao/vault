---
tags:
  - LeetCode
---

# [3484. Design Spreadsheet](https://leetcode.com/problems/design-spreadsheet/description/)  

+ 日期 : 2025/09/19  

## 問題描述  

請實作一個資料結構 `Spreadsheet`，支援以下操作：  

1. `Spreadsheet(int rows)`: 建立一個 `rows x 26` 的 `spreadsheet`，欄位從 `A` 到 `Z`，初始值皆為 `0`。  
2. `void setCell(String cell, int value)`: 設定 `cell` 的值為 `value`，其中 `cell` 以字母表示欄位，數字表示列（例如 `B5` 表示第五列第二欄）。  
3. `void resetCell(String cell)`: 將 `cell` 的值重設為 `0`。  
4. `int getValue(String formula)`: `formula` 的形式為 `=X+Y`，其中 `X` 和 `Y` 可以表示為數字也能是 `cell`。回傳 `X` 和 `Y` 的和。  
    + 例如 `=A1+5` 表示 `A1` 的值加上 `5`。  
    + 例如 `=A1+B2` 表示 `A1` 和 `B2` 的值的和。  

## 直覺想法  

1. 建立一個二維陣列 `spreadsheet` 來儲存每個儲存格的值，初始值皆為 `0`。  
2. 拆解 `cell` 第一個字元判斷屬於哪一欄，後續字元轉成整數判斷屬於哪一列。  
3. 其餘功能使用步驟 `2.` 即可。  

## 題解  

```cpp=
class Spreadsheet {
public:
    vector<vector<int>> table;
    Spreadsheet(int rows) 
        : table(vector<vector<int>>(rows+1, vector<int>(26))){
    }
    
    void setCell(string cell, int value) {
        int col = cell[0] - 'A';
        int row = stoi(cell.substr(1));
        table[row][col] = value;
    }
    
    void resetCell(string cell) {
        setCell(cell, 0);
    }
    
    int getValue(string formula) {
        int pos = formula.find('+');
        string left = formula.substr(1, pos - 1);
        string right = formula.substr(pos+1);
        int lval = 0;
        int rval = 0;
        if(left[0] - 'A' >= 0 && 'Z' - left[0] < 26) {
            int col = left[0] - 'A';
            int row = stoi(left.substr(1));
            lval = table[row][col];
        } else {
            lval = stoi(left);
        }
        if(right[0] - 'A' >= 0 && 'Z' - right[0] < 26) {
            int col = right[0] - 'A';
            int row = stoi(right.substr(1));
            rval = table[row][col];
        } else {
            rval = stoi(right);
        }
        return lval + rval;
    }
};

/**
 * Your Spreadsheet object will be instantiated and called as such:
 * Spreadsheet* obj = new Spreadsheet(rows);
 * obj->setCell(cell,value);
 * obj->resetCell(cell);
 * int param_3 = obj->getValue(formula);
 */
```

Time Complexity : $O(len(formula))$  
Space Complexity : $O(n)$  

## 心得  

又是簡單題目的一天  
